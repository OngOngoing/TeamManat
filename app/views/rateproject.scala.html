@(user: User)(project: Project)(thisRate: List[Rate])(criterias: List[RateCriterion])(images : List[ProjectImage])(teamMember : List[User])(thisComment: Comment)(setting: Map[String, String])
@import java.math.BigInteger; var isRate = false;
    @canRate = @{
        import java.util.Calendar
        import java.text.SimpleDateFormat

        val today = Calendar.getInstance.getTime
        val curTimeFormat = new SimpleDateFormat("MM-d-y HH:mm")
        val stopTime = curTimeFormat.parse(setting.get("stopTime").toString)

        today.before(stopTime)
    }

<!DOCTYPE html>

    <html>
        <head>
            <title>Exceed Vote</title>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.96.1/css/materialize.min.css">
            <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/animate.css")">
            <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/rateproject.css")">
            <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
        </head>
        <body>
            <nav class="teal lighten-1 trigger large" id="head">
                <div class="container">
                    <div class="nav-wrapper">
                        <a class="brand-logo hide-on-small-only"><img class="responsive-img" style="margin-top: 7px;" src="@routes.Assets.at("img/logo.png")" width="45%" height="45%" /></a>
                        <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="mdi-navigation-menu"></i></a>
                        <div class="center">
                            <ul class="right hide-on-med-and-down">
                                <li><a href="@routes.RateCalculator.index()"><i class="medium mdi-editor-insert-chart left"></i>Rating Result</a></li>
                                <li><a href="@routes.VoteController.showResult()"><i class="medium mdi-action-class left"></i>Voting Result</a></li>
                                <li><a href="@routes.VoteController.index()"><i class="medium mdi-maps-rate-review left"></i>Let's Vote!</a></li>
                                <li><a href="../logout"><i class="medium mdi-action-settings-power left"></i>Logout</a></li>
                            </ul>
                            <ul class="side-nav" id="mobile-demo" style="margin-right: -40px;">
                                <li><a href="@routes.RateCalculator.index()"><i class="medium mdi-editor-insert-chart left"></i>Rating Result</a></li>
                                <li><a href="@routes.VoteController.showResult()"><i class="medium mdi-action-class left"></i>Voting Result</a></li>
                                <li><a href="@routes.VoteController.index()"><i class="medium mdi-maps-rate-review left"></i>Let's Vote!</a></li>
                                <li><a href="../logout"><i class="medium mdi-action-settings-power left"></i>Logout</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </nav>
            <div class="container" style="padding-top: 75px;">
                <div class="animated fadeInDown">
                    <h2 class="trigger-text trigger pageBanner hide-on-small-only">@project.projectName</h2>
                    <h4 class="trigger-text trigger pageBanner hide-on-med-and-up center-align">@project.projectName</h4>
                    @if(user.projectId == project.id || user.idtype == User.ADMINISTRATOR) {
                        <a class="waves-effect waves-light btn" href="@routes.EditProject.index(project.id)"><i class="mdi-image-edit left"></i>
                            EDIT</a>
                    }
                </div>
                <div class="divider"></div>
                <div class="section">
                    <div class="slider">
                        <ul class="slides">
                            @images.map{image =>
                                @if(image.imgType != ProjectImage.DEFAULT) {
                                    <li>
                                        <img class = "responsive" src="../getimg/@image.Id"></img>
                                    </li>
                                }
                            }
                        </ul>
                    </div>
                </div>
                <div class="section animated fadeIn">
                    <div class="card-panel">
                        <i class="mdi-action-description small"></i>
                        <span class="black-text text-darken-2 ">
                        <div class="projectDescription" data="@project.projectDescription"></div></span>
                    </div>
                    <ul class="collapsible" data-collapsible="accordion">
                        <li>
                            <div class="collapsible-header"><i class="mdi-action-face-unlock"></i>Project Members</div>
                                <div class="collapsible-body row s8">
                                    <table class = "centered hoverable">
                                        <thead>
                                            <tr>
                                                <th data-field="cname">Firstname</th>
                                                <th data-field="score">Lastname</th>
                                            </tr>
                                        </thead>
                                        <tbody >
                                            @teamMember.map{ member =>
                                                <tr>
                                                    <td >@member.firstname</td>
                                                    <td >@member.lastname</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>   
                                </div>
                        </li>
                     </ul>
                </div>
                @if(canRate) {
                    @if(thisRate.size == 0 && thisComment == null) {
                        <div class="card-panel ">
                            <div class = "row">
                                <div class="input-field col s12">
                                    <form action="/rateproject" method="post">
                                        <div class="input-field">
                                            <input id="projectId" type="hidden" name="projectId" value="@project.id">
                                            <input id="userId" type="hidden" name="userId" value="@user.id">
                                            @criterias.map { criteria =>
                                                <input id="@criteria.id" type="hidden" name="@criteria.id" value="-1">
                                                <div class = "row" id="rating">
                                                    <div class = "criterion-name col s12 center trigger-text trigger">@criteria.name</div>
                                                    <div class="divider container"></div><br>
                                                    <div class = "col s12 center">
                                                        <div class = "hide-on-med-and-up">
                                                            @for(index <- 0 until 6) {
                                                                <a id="@criteria.id" class="waves-effect waves-teal btn btn-flat btn-floating trigger" name="criteriaButton" score="@index" href="#!">@index</a>
                                                            }
                                                        </div>
                                                        <div class = "hide-on-small-only">
                                                            @for(index <- 0 until 6) {
                                                                <a id="@criteria.id" class="waves-effect waves-teal btn btn-flat btn-floating trigger btn-large" name="criteriaButton" score="@index" href="#!">@index</a>
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                            }
                                            <div class="row">
                                                <div class="input-field col s12">
                                                    <textarea id="textarea1" class="materialize-textarea trigger" name="comment" ></textarea>
                                                    <label for="textarea1">Comment</label>
                                                </div>
                                            </div>
                                            <button type="submit" class="waves-effect waves-light btn-large trigger">
                                            <i class="mdi-action-thumb-up right"></i>
                                            Rate
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    } else {
                        <div class="card-panel ">
                            <div class="row">
                                <div class="input-field col s12">
                                    <form action="/rateproject/edit" method="post">
                                            <input id="projectId" type="hidden" name="projectId" value="@project.id">
                                            <input id="userId" type="hidden" name="userId" value="@user.id">
                                            @criterias.map { criteria =>
                                                <div class = "row" id="rating">
                                                @(isRate = false)
                                                @thisRate.map { rate =>
                                                    @if(rate.criteriaId == criteria.id ){
                                                        @(isRate = true)
                                                        <input id="@rate.criteriaId" type="hidden" name="@rate.criteriaId" value="@rate.score">
                                                        <div class = "criterion-name col s12 center text-darken-2 trigger-text trigger">@criteria.name</div>
                                                        <div class="divider container"></div><br>
                                                        <div class="row">
                                                            <div class="col s12 center">
                                                                <div class = "hide-on-med-and-up">
                                                                    @for(index<-0 until 6){
                                                                        @if(rate.score == index){ 
                                                                            <a id="@rate.criteriaId" class=" waves-effect waves-teal btn btn-floating trigger" name="criteriaButton" score="@index" href="#!">@index</a>
                                                                        }else{
                                                                            <a id="@rate.criteriaId" class=" waves-effect waves-teal btn btn-flat btn-floating trigger" name="criteriaButton" score="@index" href="#!">@index</a>
                                                                        }
                                                                    }
                                                                </div>
                                                                <div class = "hide-on-small-only">
                                                                    @for(index<-0 until 6){
                                                                        @if(rate.score == index){ 
                                                                            <a id="@rate.criteriaId" class=" waves-effect waves-teal btn btn-large btn-floating trigger" name="criteriaButton" score="@index" href="#!">@index</a>
                                                                        }else{
                                                                            <a id="@rate.criteriaId" class=" waves-effect waves-teal btn btn-large btn-flat btn-floating trigger" name="criteriaButton" score="@index" href="#!">@index</a>
                                                                        }
                                                                    }
                                                                </div>
                                                                
                                                            </div>
                                                        </div>

                                                    }
                                                }
                                                @if(isRate == false){
                                                    <input id="@criteria.id" type="hidden" name="@criteria.id" value="-1">
                                                    <div class = "row" id="rating">
                                                        <div class = "criterion-name col s12 center trigger-text trigger">@criteria.name</div>
                                                        <div class="divider container"></div><br>
                                                        <div class = "col s12 center">
                                                            <div class = "hide-on-med-and-up">
                                                                @for(index <- 0 until 6) {
                                                                    <a id="@criteria.id" class="waves-effect waves-teal btn btn-flat btn-floating trigger" name="criteriaButton" score="@index" href="#!">@index</a>
                                                                }
                                                            </div>
                                                            <div class = "hide-on-small-only">
                                                                @for(index <- 0 until 6) {
                                                                    <a id="@criteria.id" class="waves-effect waves-teal btn btn-flat btn-floating trigger btn-large" name="criteriaButton" score="@index" href="#!">@index</a>
                                                                }
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                                </div>
                                            }   
                                        <div class="row">
                                            <div class="input-field col s12">
                                                @if(thisComment != null){
                                                    <textarea id="textarea1" class="materialize-textarea trigger" name="comment" >@thisComment.comment</textarea>
                                                    <label for="textarea1">Comment</label>
                                                }else {
                                                    <textarea id="textarea1" class="materialize-textarea trigger" name="comment" ></textarea>
                                                    <label for="textarea1">Comment</label>
                                                }
                                                
                                            </div>
                                        </div>
                                        <button type="submit" class="waves-effect waves-light btn-large trigger"><i class="mdi-action-thumb-up right"></i>
                                        Update
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        }
                } else {
                    <div class="section animated fadeIn">
                        <div class="row">
                            <h2 class="center col s12 trigger trigger-text">Time's up!</h2>
                            <div class ="center col s12">
                                <a href="@routes.RateCalculator.index()" class = "btn btn-large trigger"><i class="medium mdi-editor-insert-chart left"></i>Rating Result<i class="mdi-content-send right"></i></a>
                            </div>
                        </div>
                    </div>
                }

            </div>

            <div class="fixed-action-btn animated bounceInUp" style="bottom : 45 px ; right : 40 px ;">
                <a class="btn-floating btn-large trigger" href="..">
                    <i class="large mdi-action-home waves-effect waves-light"></i>
                </a>
                <ul>
                    <li><a class="btn-floating red " href="../logout"><i class="large mdi-action-settings-power"></i></a></li>
                    @if(user.idtype == User.ADMINISTRATOR){
                        <li><a class="btn-floating yellow derken-1" href="../adminpage"><i class="large mdi-action-settings waves-effect waves-light"></i></a></li>
                    }
                    
                </ul>
            </div>

            <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.96.1/js/materialize.min.js"></script>
            <script src="@routes.Assets.at("javascripts/Markdown.Converter.js")"></script>
            <script src="@routes.Assets.at("javascripts/Markdown.Sanitizer.js")"></script>
            <script src="@routes.Assets.at("javascripts/init.js")" type="text/javascript"></script>
            <script src="@routes.Assets.at("javascripts/rateproject.js")" type="text/javascript"></script>
            @if(flash.contains("rate_success")) {
                <script type="text/javascript">
                Materialize.toast('@flash.get("rate_success")', 4000)
                </script>
            }
            @if(flash.contains("edit_success")) {
                <script type="text/javascript">
                Materialize.toast('@flash.get("edit_success")', 4000)
                </script>
            }

        </body>
    </html>
